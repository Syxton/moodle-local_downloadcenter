define(["jquery","core/str"],function(a,b){var c,d,e,f={},g=!1,h=function(g){c=g,b.get_strings([{key:"all",component:"moodle"},{key:"none",component:"moodle"},{key:"select",component:"moodle"},{key:"showtypes",component:"backup"},{key:"hidetypes",component:"backup"}]).done(function(b){f.all=b[0],f.none=b[1],f.select=b[2],f.showtypes=b[3],f.hidetypes=b[4];var g=a("#mform1 fieldset").first();d=g.parent("form").prop("id");var h=l("include_setting section_level","included",f.select,' (<a id="downloadcenter-bytype" href="#">'+f.showtypes+"</a>)"),m=a(document.createElement("div"));m.addClass("grouped_settings section_level block"),m.html(h),m.prependTo(g),e=a(document.createElement("div")),e.prop("id","mod_select_links"),e.appendTo(m),e.hide();for(var n in c)if(c.hasOwnProperty(n)){h=l("include_setting section_level","mod_"+n,c[n]);var o=a(document.createElement("div"));o.addClass("grouped_settings section_level"),o.html(h),o.appendTo(e),j(o,n)}a("#downloadcenter-all-included").click(function(a){k(a,!0,"item_")}),a("#downloadcenter-none-included").click(function(a){k(a,!1,"item_")}),a("#downloadcenter-bytype").click(function(){i()})})},i=function(){var b=a("#downloadcenter-bytype");g?b.text(f.showtypes):b.text(f.hidetypes),e.animate({height:"toggle"},500,"swing"),g=!g},j=function(b,c){a("#downloadcenter-all-mod_"+c).click(function(a){k(a,!0,"item_",c)}),a("#downloadcenter-none-mod_"+c).click(function(a){k(a,!1,"item_",c)})},k=function(b,c,e,f){b.preventDefault();var g="";"undefined"!=typeof f&&(g="item_"+f+"_");var h=e.length;a('input[type="checkbox"]').each(function(b,d){d=a(d);var f=d.prop("name");g&&f.substring(0,g.length)!==g||f.substring(0,h)===e&&d.prop("checked",c)}),d&&M.form&&M.form.updateFormState(d)},l=function(a,b,c,d){return"undefined"==typeof d&&(d=""),'<div class="'+a+'"><div class="fitem fitem_fcheckbox downloadcenter_selector"><div class="fitemtitle">'+c+'</div><div class="felement"><a id="downloadcenter-all-'+b+'" href="#">'+f.all+'</a> / <a id="downloadcenter-none-'+b+'" href="#">'+f.none+"</a>"+d+"</div></div></div>"};return{init:function(a){return new h(a)}}});