define(["jquery","core/str","core/url"],function(e,n,o){var t,c,i,r={},l=!1,d=function(){var n=e("#downloadcenter-bytype");l?n.text(r.showtypes):n.text(r.hidetypes),i.animate({height:"toggle"},500,"swing"),l=!l},a=function(n,o){e("#downloadcenter-all-mod_"+o).click(function(e){s(e,!0,"item_",o)}),e("#downloadcenter-none-mod_"+o).click(function(e){s(e,!1,"item_",o)})},s=function(n,o,t,i){n.preventDefault();var r="";void 0!==i&&(r="item_"+i+"_");var l=t.length;e('input[type="checkbox"]').each(function(n,c){var i=(c=e(c)).prop("name");r&&i.substring(0,r.length)!==r||(i.substring(0,l)===t&&c.prop("checked",o),o&&c.closest(".card.block").find(".form-group:first-child input").prop("checked",o))}),c&&M.form&&M.form.updateFormState(c)},p=function(e,n){var o='<a id="downloadcenter-all-'+e+'" href="#">'+r.all+"</a> / ";return o+='<a id="downloadcenter-none-'+e+'" href="#">'+r.none+"</a>",m(n,o)},m=function(e,n){var o='<div class="form-group row fitem downloadcenter_selector">';return o+='<div class="col-md-3"></div>',o+='<div class="col-md-9">',o+='<label><span class="itemtitle">'+e+"</span></label>",o+='<span class="text-nowrap">'+n+"</span>",o+="</div>",o+="</div>"};return{init:function(l){return new function(l){t=l,n.get_strings([{key:"all",component:"moodle"},{key:"none",component:"moodle"},{key:"select",component:"moodle"},{key:"showtypes",component:"backup"},{key:"hidetypes",component:"backup"}]).done(function(n){r.all=n[0],r.none=n[1],r.select=n[2],r.showtypes=n[3],r.hidetypes=n[4];var l=e("#mform1 .card.block").first();c=l.closest("form").prop("id");var u=p("included",r.select);u+=m('(<a id="downloadcenter-bytype" href="#">'+r.showtypes+"</a>)","");var f=e(document.createElement("div"));f.addClass("grouped_settings section_level block card"),f.html(u),f.insertBefore(l),(i=e(document.createElement("div"))).prop("id","mod_select_links"),i.prop("class","m-l-2"),i.appendTo(f),i.hide();for(var v in t)if(t.hasOwnProperty(v)){var h='<img src="'+o.imageUrl("icon","mod_"+v)+'" class="activityicon" />';u=p("mod_"+v,h+t[v]);var y=e(document.createElement("div"));y.addClass("grouped_settings section_level"),y.html(u),y.appendTo(i),a(y,v)}e("#downloadcenter-all-included").click(function(e){s(e,!0,"item_")}),e("#downloadcenter-none-included").click(function(e){s(e,!1,"item_")}),e("#downloadcenter-bytype").click(function(){d()})})}(l)}}});