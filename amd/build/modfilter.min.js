define(["jquery","core/str","core/url"],function(e,n,o){var t,c,i,r={},a=!1,l=function(a){t=a,n.get_strings([{key:"all",component:"moodle"},{key:"none",component:"moodle"},{key:"select",component:"moodle"},{key:"showtypes",component:"backup"},{key:"hidetypes",component:"backup"}]).done(function(n){r.all=n[0],r.none=n[1],r.select=n[2],r.showtypes=n[3],r.hidetypes=n[4];var a=e("#mform1 .card.block").first();c=a.parent("form").prop("id");var l=m("included",r.select);l+=u('(<a id="downloadcenter-bytype" href="#">'+r.showtypes+"</a>)","");var f=e(document.createElement("div"));f.addClass("grouped_settings section_level block card"),f.html(l),f.insertBefore(a),(i=e(document.createElement("div"))).prop("id","mod_select_links"),i.prop("class","m-l-2"),i.appendTo(f),i.hide();for(var v in t)if(t.hasOwnProperty(v)){var y='<img src="'+o.imageUrl("icon","mod_"+v)+'" class="activityicon" />';l=m("mod_"+v,y+t[v]);var h=e(document.createElement("div"));h.addClass("grouped_settings section_level"),h.html(l),h.appendTo(i),s(h,v)}e("#downloadcenter-all-included").click(function(e){p(e,!0,"item_")}),e("#downloadcenter-none-included").click(function(e){p(e,!1,"item_")}),e("#downloadcenter-bytype").click(function(){d()})})},d=function(){var n=e("#downloadcenter-bytype");a?n.text(r.showtypes):n.text(r.hidetypes),i.animate({height:"toggle"},500,"swing"),a=!a},s=function(n,o){e("#downloadcenter-all-mod_"+o).click(function(e){p(e,!0,"item_",o)}),e("#downloadcenter-none-mod_"+o).click(function(e){p(e,!1,"item_",o)})},p=function(n,o,t,i){n.preventDefault();var r="";void 0!==i&&(r="item_"+i+"_");var a=t.length;e('input[type="checkbox"]').each(function(n,c){var i=(c=e(c)).prop("name");r&&i.substring(0,r.length)!==r||i.substring(0,a)===t&&c.prop("checked",o)}),c&&M.form&&M.form.updateFormState(c)},m=function(e,n){var o='<a id="downloadcenter-all-'+e+'" href="#">'+r.all+"</a> / ";return o+='<a id="downloadcenter-none-'+e+'" href="#">'+r.none+"</a>",u(n,o)},u=function(e,n){var o='<div class="form-group row fitem downloadcenter_selector">';return o+='<div class="col-md-3"></div>',o+='<div class="col-md-9">',o+='<label><span class="itemtitle">'+e+"</span></label>",o+='<span class="text-nowrap">'+n+"</span>",o+="</div>",o+="</div>"};return{init:function(e){return new l(e)}}});